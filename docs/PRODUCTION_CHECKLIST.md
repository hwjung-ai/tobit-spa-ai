# Tobit SPA AI - 프로덕션 준비 체크리스트

**작성 일시**: 2026-01-18
**현재 상태**: Phase 0 준비 단계
**완료도**: 35% (P0 기본 항목 완료)

---

## 1. 보안 (Security)

### 1.1 인증 & 권한 관리
- [ ] JWT 토큰 발급 엔드포인트 구현 (`POST /auth/login`)
- [ ] JWT 토큰 갱신 엔드포인트 구현 (`POST /auth/refresh`)
- [ ] JWT 토큰 검증 미들웨어 적용
- [ ] 토큰 블랙리스트 (Redis) 구현
- [ ] `TbUser` 테이블 생성 (사용자 정보)
- [ ] `TbRole` 테이블 생성 (역할)
- [ ] `TbPermission` 테이블 생성 (권한)
- [ ] RBAC 미들웨어 구현
- [ ] 테넌트 격리 필터링 적용 (모든 쿼리)
- [ ] 로그인 실패 제한 정책 (3회 이상 실패 시 계정 잠금, 30분)

### 1.2 데이터 보호
- [ ] 비밀번호 해싱 (bcrypt 또는 argon2)
- [ ] 민감 데이터 암호화 (password, api_key, access_token)
- [ ] pgcrypto 확장 사용 (PostgreSQL 저장 암호화)
- [ ] 데이터베이스 연결 암호화 (SSL/TLS)
- [ ] API 응답에서 민감 데이터 제거

### 1.3 통신 보안
- [ ] HTTPS 강제 (HTTP → HTTPS 리다이렉트)
- [ ] CORS 설정 정밀화 (허용 도메인 명시)
- [ ] Content Security Policy (CSP) 헤더 추가
- [ ] X-Frame-Options, X-Content-Type-Options 설정
- [ ] SSL 인증서 설치 (자체 서명 또는 Let's Encrypt)

### 1.4 API 보안
- [ ] API Key 발급 메커니즘 구현
- [ ] Rate limiting 정책 (사용자당 요청 제한)
- [ ] API 요청/응답 로깅 (감사 목적)
- [ ] SQL Injection 방지 (SQLModel 매개변수화)
- [ ] XSS 방지 (응답 데이터 이스케이프)

---

## 2. 데이터 관리 (Data Management)

### 2.1 마이그레이션 & 스키마
- [x] P0-1: Request Tracing & Audit Logging ✅
- [x] P0-2: Asset Registry System ✅
- [x] P0-3: Runtime Settings Externalization ✅
- [ ] 0031: User & Role tables (인증 시스템)
- [ ] 0032: API versioning tables (API Manager)
- [ ] 0033: Document metadata tables (Document Search)
- [ ] 0034: Chat history enhancement tables (Chat history)
- [ ] Alembic migration 자동화 완료 (startup 시)

### 2.2 백업 & 복구
- [ ] 자동 백업 정책 수립 (일일, 주간, 월간)
- [ ] 백업 검증 프로세스 (복구 테스트)
- [ ] 백업 저장소 설정 (로컬 + 원격)
- [ ] 재해 복구 계획 (RTO, RPO 정의)
- [ ] 백업/복구 자동화 스크립트

### 2.3 데이터 정합성
- [ ] 정기 데이터 무결성 검사 (cronjob)
- [ ] 중복 데이터 감지 및 정리
- [ ] 고아 데이터 정리 정책
- [ ] 데이터 정합성 리포트 (주간)

---

## 3. OPS AI 강화 (AI Orchestration)

### 3.1 LangGraph 통합
- [ ] 상태 머신 설계 (상태 정의, 노드, 엣지)
- [ ] LangGraph 환경 설정 (의존성 설치)
- [ ] 기본 워크플로우 프로토타입 구현
- [ ] 상태 전이 테스트
- [ ] 에러 핸들링 (무한 루프 방지, 타임아웃)

### 3.2 오케스트레이터 개선
- [ ] 질의 분해 로직 구현 (질문 → 서브 질문)
- [ ] 병렬/순차 실행 스케줄러
- [ ] 중간 결과 캐싱 (Redis)
- [ ] 결과 집계 및 최종 응답 생성
- [ ] 실행 추적 로그 (trace_id 포함)

### 3.3 MCP (Model Context Protocol)
- [ ] PostgreSQL 어댑터 구현
  - 테이블 스키마 정보 제공
  - read-only 쿼리 필터링
  - 결과 직렬화
- [ ] Neo4j 어댑터 구현
  - Cypher 쿼리 실행
  - 그래프 탐색 기능
  - 경로 분석
- [ ] 보안 검증 (민감 데이터 마스킹)
- [ ] LLM 맥락 제공

### 3.4 CI 변경 관리
- [ ] 변경 이력 테이블 설계 (`TbChangeHistory`)
- [ ] 변경 추적 기능 구현
- [ ] 변경 승인 워크플로우 (선택)
- [ ] 중복 CI 감지 알고리즘
- [ ] 데이터 정합성 검증 리포트

---

## 4. 문서 검색 (Document Search)

### 4.1 문서 파처 (Parser)
- [ ] PDF 파서 구현 (PDFMiner, PyPDF)
- [ ] Word (.docx) 파서 구현 (python-docx)
- [ ] Excel (.xlsx) 파서 구현 (openpyxl)
- [ ] PowerPoint (.pptx) 파서 구현 (python-pptx)
- [ ] 이미지 OCR 구현 (Tesseract, EasyOCR) - 선택

### 4.2 청킹 & 벡터화
- [ ] 청킹 엔진 구현 (토큰 기반, 512 기본)
- [ ] 슬라이딩 윈도우 구현 (문맥 연속성)
- [ ] 헤더/제목 정보 보존
- [ ] Embedding API 통합 (OpenAI, Hugging Face)
- [ ] pgvector 저장소 활용
- [ ] 벡터 인덱스 생성 (IVFFLAT, HNSW)

### 4.3 비동기 처리
- [ ] RQ (Redis Queue) 통합
- [ ] 백그라운드 태스크 관리
- [ ] 업로드 → 파싱 → 인덱싱 상태 추적
- [ ] SSE 또는 WebSocket 진행 상황 전송
- [ ] 실패 처리 및 재시도 로직

### 4.4 검색 & 신뢰성
- [ ] 벡터 검색 구현 (pgvector)
- [ ] BM25 텍스트 검색 구현
- [ ] 하이브리드 검색 (벡터 + BM25 조합)
- [ ] 신뢰도 스코어 계산
- [ ] 출처 정보 및 스니펫 제공
- [ ] 검색 결과 인용 기능

### 4.5 접근 제어
- [ ] 테넌트별 문서 격리
- [ ] 사용자별 접근 권한 관리
- [ ] 공유 권한 (공개/비공개/제한)
- [ ] 문서 업로드/다운로드/삭제 감사 로그

---

## 5. 채팅 & 이력 (Chat & History)

### 5.1 이력 관리 강화
- [ ] 자동 제목 생성 (LLM 기반)
- [ ] 사용자 수동 제목 변경 기능
- [ ] 토큰 사용량 추적 (input/output)
- [ ] 누적 토큰 사용량 표시
- [ ] 토큰 비용 계산

### 5.2 결과물 보존
- [ ] 차트, 테이블, 스크린샷 저장
- [ ] 결과물 다운로드 기능 (PNG, CSV, JSON)
- [ ] 결과물 버전 관리

### 5.3 이력 검색 & 관리
- [ ] 이력 검색 필터 (날짜, 키워드, 태그)
- [ ] 소프트 삭제 (복구 가능)
- [ ] 이력 정리 정책 (자동 보관/삭제)
- [ ] 이력 공유 기능

---

## 6. API Manager 강화

### 6.1 버전 관리
- [ ] API 버전 번호 체계 (semantic versioning)
- [ ] 변경 로그 자동 생성
- [ ] 호환성 정보 (breaking changes)
- [ ] Diff 표시 기능

### 6.2 API 검증
- [ ] SQL 구문 검증 (SQL parser)
- [ ] 스키마 검증 (DB 스키마와 맞춤)
- [ ] 성능 검증 (쿼리 실행 계획 분석)
- [ ] 테스트 케이스 (샘플 데이터 실행)

### 6.3 권한 관리
- [ ] API별 실행 권한
- [ ] API별 수정 권한
- [ ] API 타입별 권한 (system/custom)
- [ ] 감사 로그 (API 실행 기록)

---

## 7. 배포 & 운영 (Deployment & Operations)

### 7.1 설치 자동화
- [ ] 설치 스크립트 작성 (`tobitspaai_YYYYMMDD.sh`)
- [ ] 의존성 자동 설치 (Python, Node, PostgreSQL, Redis, Neo4j)
- [ ] 환경변수 설정 마법사
- [ ] 초기 데이터 로드
- [ ] 스크립트 테스트 (Windows, Linux, macOS)

### 7.2 Docker & Docker Compose
- [ ] API Dockerfile
- [ ] Web Dockerfile
- [ ] `docker-compose.yml` (개발)
- [ ] `docker-compose.prod.yml` (프로덕션)
- [ ] 이중화 설정 (API x2, 로드 밸런싱)
- [ ] 헬스 체크 구현

### 7.3 모니터링 & 로깅
- [ ] Prometheus 메트릭 수집
  - API 응답 시간
  - 에러율
  - 토큰 사용량
  - DB 쿼리 시간
- [ ] Grafana 대시보드 구성
- [ ] 임계치 기반 알림 (Slack, Email)
- [ ] 구조화된 로깅 (JSON 형식)
- [ ] 로그 로테이션 정책
- [ ] 장기 로그 저장소 (S3, GCS)

### 7.4 성능 최적화
- [ ] 데이터베이스 인덱스 최적화
- [ ] 쿼리 캐싱 (Redis)
- [ ] API 응답 압축 (gzip)
- [ ] CDN 설정 (정적 콘텐츠)
- [ ] 타임아웃 정책 설정

---

## 8. 테스트 & 품질 (Testing & Quality)

### 8.1 단위 테스트
- [ ] pytest 환경 구성
- [ ] 비즈니스 로직 테스트 (목표 80% 커버리지)
- [ ] CRUD 테스트
- [ ] 유틸리티 함수 테스트
- [ ] 에러 케이스 테스트

### 8.2 통합 테스트
- [ ] API 엔드포인트 테스트
- [ ] DB 상호작용 테스트
- [ ] 마이그레이션 검증
- [ ] 권한 검증 테스트

### 8.3 E2E 테스트 (Playwright)
- [ ] 로그인 플로우
- [ ] 질의 제출 및 응답
- [ ] 자산 발행 플로우
- [ ] 보고서 생성 및 다운로드
- [ ] 에러 처리

### 8.4 성능 테스트
- [ ] 동시 사용자 로드 테스트 (k6, Locust)
- [ ] 응답 시간 목표 달성 확인 (<100ms P95)
- [ ] 메모리/CPU 사용량 모니터링

### 8.5 보안 테스트
- [ ] SQL Injection 테스트
- [ ] XSS 테스트
- [ ] CSRF 토큰 검증
- [ ] 인증/권한 바이패스 테스트
- [ ] 암호화 검증

### 8.6 CI/CD 파이프라인
- [ ] GitHub Actions 워크플로우
- [ ] 자동 린트 (Ruff, Prettier)
- [ ] 자동 테스트 실행
- [ ] 자동 빌드
- [ ] 자동 배포 (선택)

---

## 9. 문서화 (Documentation)

### 9.1 사용자 가이드
- [ ] 설치 가이드
- [ ] 초기 설정 가이드
- [ ] 기본 사용법 (질의, 자산 관리, 보고서)
- [ ] FAQ 및 트러블슈팅

### 9.2 운영 가이드
- [ ] 백업/복구 절차
- [ ] 모니터링 대시보드 해석
- [ ] 알림 대응 절차
- [ ] 성능 튜닝 가이드
- [ ] 장애 대응 절차

### 9.3 API 문서
- [ ] OpenAPI/Swagger 스펙
- [ ] 모든 엔드포인트 문서화
- [ ] 요청/응답 예시
- [ ] 에러 코드 및 메시지

### 9.4 개발 가이드
- [ ] 아키텍처 설명
- [ ] 추가 기능 개발 가이드
- [ ] 테스트 작성 가이드
- [ ] 배포 절차

---

## 10. 최종 검증 (Final Validation)

### 10.1 기능 검증
- [ ] 모든 주요 기능 테스트 완료
- [ ] 에러 처리 검증
- [ ] 엣지 케이스 테스트
- [ ] 성능 목표 달성 확인

### 10.2 보안 검증
- [ ] 보안 감시 완료 (외부 전문가 추천)
- [ ] 취약점 스캔 (OWASP top 10)
- [ ] 침투 테스트 (선택)

### 10.3 운영 준비
- [ ] 운영팀 교육 완료
- [ ] 장애 복구 절차 테스트
- [ ] 모니터링 알림 설정
- [ ] 지원 체계 구축

### 10.4 사용자 수용 테스트 (UAT)
- [ ] 베타 사용자 선정 (5-10명)
- [ ] 실제 사용 시나리오 테스트
- [ ] 피드백 수집 및 버그 수정
- [ ] 최종 승인

---

## 11. 프로덕션 배포 (Production Deployment)

### 배포 전
- [ ] 최종 백업
- [ ] 배포 롤백 계획 준비
- [ ] 배포 팀 준비 (On-call)
- [ ] 모니터링 알림 설정
- [ ] 커뮤니케이션 계획 (사용자 공지)

### 배포 중
- [ ] 무중단 배포 (Blue-Green Deployment)
- [ ] 단계적 롤아웃 (10% → 50% → 100%)
- [ ] 실시간 모니터링
- [ ] 빠른 롤백 능력 확인

### 배포 후
- [ ] 배포 완료 확인
- [ ] 주요 기능 스모크 테스트
- [ ] 사용자 피드백 모니터링
- [ ] 성능 메트릭 확인

---

## 12. 배포 후 운영 (Post-Deployment)

### 주간
- [ ] 시스템 상태 모니터링
- [ ] 사용자 피드백 수집
- [ ] 버그 리포트 분류
- [ ] 성능 메트릭 분석

### 월간
- [ ] 보안 패치 적용
- [ ] 의존성 업그레이드
- [ ] 성능 최적화
- [ ] 용량 계획 (Capacity Planning)

### 분기
- [ ] 백업 검증 (복구 테스트)
- [ ] 재해 복구 훈련
- [ ] 보안 감시
- [ ] 다음 기능 계획

---

## 13. 진행 현황 (Status)

| 영역 | 항목 | 상태 | 진행도 | 담당자 |
|------|------|------|--------|--------|
| 보안 | JWT 인증 | ⏳ 대기 | 0% | TBD |
| 보안 | RBAC | ⏳ 대기 | 0% | TBD |
| OPS AI | LangGraph | ⏳ 대기 | 0% | TBD |
| OPS AI | MCP | ⏳ 대기 | 0% | TBD |
| 문서검색 | 파서 | ⏳ 대기 | 0% | TBD |
| 배포 | Docker | ⏳ 대기 | 0% | TBD |
| 테스트 | 단위 테스트 | ⏳ 대기 | 0% | TBD |
| 테스트 | E2E 테스트 | ⏳ 대기 | 0% | TBD |

---

## 14. 범례

| 상태 | 의미 |
|------|------|
| ✅ | 완료 |
| ⏳ | 대기 중 |
| 🔄 | 진행 중 |
| ❌ | 실패 |
| 🔴 | 차단됨 |
| 🟠 | 위험 |

---

**마지막 업데이트**: 2026-01-18
**다음 리뷰**: 2026-01-25
**담당자**: [TBD]
