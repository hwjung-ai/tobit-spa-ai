Tool type ci already registered; skipping re-registration
Tool type graph already registered; skipping re-registration
Tool type metric already registered; skipping re-registration
Tool type history already registered; skipping re-registration
Tool type cep already registered; skipping re-registration
INFO:     Started server process [120304]
INFO:     Waiting for application startup.
2026-01-19T12:15:50+0900 INFO app.modules.cep_builder.scheduler request_id=- tenant_id=- trace_id=- mode=- [CEP] Scheduler disabled by environment variable taskName=Task-2 asctime=2026-01-19T12:15:50+0900
2026-01-19T12:15:50+0900 INFO app.shared.config_loader request_id=- tenant_id=- trace_id=- mode=- Started watching for changes in /home/spa/tobit-spa-ai/apps/api/resources taskName=Task-2 asctime=2026-01-19T12:15:50+0900
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2026-01-19 12:15:54,022 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2026-01-19T12:15:54+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- select pg_catalog.version() taskName=starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro asctime=2026-01-19T12:15:54+0900
2026-01-19 12:15:54,022 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-19T12:15:54+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [raw sql] {} taskName=starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro asctime=2026-01-19T12:15:54+0900
2026-01-19 12:15:54,060 INFO sqlalchemy.engine.Engine select current_schema()
2026-01-19T12:15:54+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- select current_schema() taskName=starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro asctime=2026-01-19T12:15:54+0900
2026-01-19 12:15:54,060 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-19T12:15:54+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [raw sql] {} taskName=starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro asctime=2026-01-19T12:15:54+0900
2026-01-19 12:15:54,100 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2026-01-19T12:15:54+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- show standard_conforming_strings taskName=starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro asctime=2026-01-19T12:15:54+0900
2026-01-19 12:15:54,101 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-19T12:15:54+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [raw sql] {} taskName=starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro asctime=2026-01-19T12:15:54+0900
2026-01-19 12:15:54,203 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-19T12:15:54+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- BEGIN (implicit) taskName=starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro asctime=2026-01-19T12:15:54+0900
2026-01-19 12:15:54,206 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM tb_cep_notification_log 
WHERE tb_cep_notification_log.ack IS false
2026-01-19T12:15:54+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- SELECT count(*) AS count_1 
FROM tb_cep_notification_log 
WHERE tb_cep_notification_log.ack IS false taskName=starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro asctime=2026-01-19T12:15:54+0900
2026-01-19 12:15:54,206 INFO sqlalchemy.engine.Engine [generated in 0.00030s] {}
2026-01-19T12:15:54+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [generated in 0.00030s] {} taskName=starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro asctime=2026-01-19T12:15:54+0900
2026-01-19 12:15:54,263 INFO sqlalchemy.engine.Engine SELECT coalesce(tb_cep_notification.trigger ->> %(trigger_1)s::TEXT, %(coalesce_1)s::VARCHAR) AS severity, count(*) AS count_1 
FROM tb_cep_notification_log JOIN tb_cep_notification ON tb_cep_notification_log.notification_id = tb_cep_notification.notification_id GROUP BY coalesce(tb_cep_notification.trigger ->> %(trigger_1)s::TEXT, %(coalesce_1)s::VARCHAR)
2026-01-19T12:15:54+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- SELECT coalesce(tb_cep_notification.trigger ->> %(trigger_1)s::TEXT, %(coalesce_1)s::VARCHAR) AS severity, count(*) AS count_1 
FROM tb_cep_notification_log JOIN tb_cep_notification ON tb_cep_notification_log.notification_id = tb_cep_notification.notification_id GROUP BY coalesce(tb_cep_notification.trigger ->> %(trigger_1)s::TEXT, %(coalesce_1)s::VARCHAR) taskName=starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro asctime=2026-01-19T12:15:54+0900
2026-01-19 12:15:54,263 INFO sqlalchemy.engine.Engine [generated in 0.00044s] {'trigger_1': 'severity', 'coalesce_1': 'info'}
2026-01-19T12:15:54+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [generated in 0.00044s] {'trigger_1': 'severity', 'coalesce_1': 'info'} taskName=starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro asctime=2026-01-19T12:15:54+0900
INFO:     127.0.0.1:41356 - "GET /cep/events/stream HTTP/1.1" 200 OK
2026-01-19 12:16:08,950 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2026-01-19T12:16:08+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- select pg_catalog.version() taskName=None asctime=2026-01-19T12:16:08+0900
2026-01-19 12:16:08,951 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-19T12:16:08+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [raw sql] {} taskName=None asctime=2026-01-19T12:16:08+0900
2026-01-19 12:16:08,986 INFO sqlalchemy.engine.Engine select current_schema()
2026-01-19T12:16:08+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- select current_schema() taskName=None asctime=2026-01-19T12:16:08+0900
2026-01-19 12:16:08,986 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-19T12:16:08+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [raw sql] {} taskName=None asctime=2026-01-19T12:16:08+0900
2026-01-19 12:16:09,028 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- show standard_conforming_strings taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,028 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [raw sql] {} taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,138 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- BEGIN (implicit) taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,141 INFO sqlalchemy.engine.Engine SELECT tb_user.username, tb_user.password_hash, tb_user.role, tb_user.tenant_id, tb_user.is_active, tb_user.last_login_at, tb_user.email_encrypted, tb_user.phone_encrypted, tb_user.id, tb_user.created_at, tb_user.updated_at 
FROM tb_user 
WHERE tb_user.username = %(username_1)s::VARCHAR
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- SELECT tb_user.username, tb_user.password_hash, tb_user.role, tb_user.tenant_id, tb_user.is_active, tb_user.last_login_at, tb_user.email_encrypted, tb_user.phone_encrypted, tb_user.id, tb_user.created_at, tb_user.updated_at 
FROM tb_user 
WHERE tb_user.username = %(username_1)s::VARCHAR taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,141 INFO sqlalchemy.engine.Engine [generated in 0.00033s] {'username_1': 'admin@tobit.local'}
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [generated in 0.00033s] {'username_1': 'admin@tobit.local'} taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19T12:16:09+0900 DEBUG passlib.handlers.bcrypt request_id=- tenant_id=- trace_id=- mode=- detected 'bcrypt' backend, version '4.0.1' taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19T12:16:09+0900 DEBUG passlib.handlers.bcrypt request_id=- tenant_id=- trace_id=- mode=- 'bcrypt' backend lacks $2$ support, enabling workaround taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,470 INFO sqlalchemy.engine.Engine INSERT INTO tb_refresh_token (user_id, token_hash, expires_at, revoked_at, id, created_at) VALUES (%(user_id)s::VARCHAR, %(token_hash)s::VARCHAR, %(expires_at)s::TIMESTAMP WITHOUT TIME ZONE, %(revoked_at)s::TIMESTAMP WITHOUT TIME ZONE, %(id)s::VARCHAR, %(created_at)s::TIMESTAMP WITHOUT TIME ZONE)
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- INSERT INTO tb_refresh_token (user_id, token_hash, expires_at, revoked_at, id, created_at) VALUES (%(user_id)s::VARCHAR, %(token_hash)s::VARCHAR, %(expires_at)s::TIMESTAMP WITHOUT TIME ZONE, %(revoked_at)s::TIMESTAMP WITHOUT TIME ZONE, %(id)s::VARCHAR, %(created_at)s::TIMESTAMP WITHOUT TIME ZONE) taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,471 INFO sqlalchemy.engine.Engine [generated in 0.00040s] {'user_id': '84a3c0e5-7fd3-4232-bf9c-bc431c948957', 'token_hash': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4NGEzYzBlNS03ZmQzLTQyMzItYmY5Yy1iYzQzMWM5NDg5NTciLCJleHAiOjE3NjkzOTczNjksInR5cGUiOiJyZWZyZXNoIn0.eIw6l4ZPoccosD4Vzn8Y-wX4PNsEyYcCgB4RWqb5GAk', 'expires_at': datetime.datetime(2026, 1, 26, 3, 16, 9, 469202, tzinfo=datetime.timezone.utc), 'revoked_at': None, 'id': '635e8bfa-6049-46f7-971c-057d7219efe0', 'created_at': datetime.datetime(2026, 1, 19, 3, 16, 9, 469335, tzinfo=datetime.timezone.utc)}
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [generated in 0.00040s] {'user_id': '84a3c0e5-7fd3-4232-bf9c-bc431c948957', 'token_hash': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4NGEzYzBlNS03ZmQzLTQyMzItYmY5Yy1iYzQzMWM5NDg5NTciLCJleHAiOjE3NjkzOTczNjksInR5cGUiOiJyZWZyZXNoIn0.eIw6l4ZPoccosD4Vzn8Y-wX4PNsEyYcCgB4RWqb5GAk', 'expires_at': datetime.datetime(2026, 1, 26, 3, 16, 9, 469202, tzinfo=datetime.timezone.utc), 'revoked_at': None, 'id': '635e8bfa-6049-46f7-971c-057d7219efe0', 'created_at': datetime.datetime(2026, 1, 19, 3, 16, 9, 469335, tzinfo=datetime.timezone.utc)} taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,477 INFO sqlalchemy.engine.Engine UPDATE tb_user SET last_login_at=%(last_login_at)s::TIMESTAMP WITHOUT TIME ZONE WHERE tb_user.id = %(tb_user_id)s::VARCHAR
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- UPDATE tb_user SET last_login_at=%(last_login_at)s::TIMESTAMP WITHOUT TIME ZONE WHERE tb_user.id = %(tb_user_id)s::VARCHAR taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,478 INFO sqlalchemy.engine.Engine [generated in 0.00037s] {'last_login_at': datetime.datetime(2026, 1, 19, 3, 16, 9, 469463, tzinfo=datetime.timezone.utc), 'tb_user_id': '84a3c0e5-7fd3-4232-bf9c-bc431c948957'}
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [generated in 0.00037s] {'last_login_at': datetime.datetime(2026, 1, 19, 3, 16, 9, 469463, tzinfo=datetime.timezone.utc), 'tb_user_id': '84a3c0e5-7fd3-4232-bf9c-bc431c948957'} taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,497 INFO sqlalchemy.engine.Engine COMMIT
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- COMMIT taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,519 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- BEGIN (implicit) taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,520 INFO sqlalchemy.engine.Engine SELECT tb_user.username AS tb_user_username, tb_user.password_hash AS tb_user_password_hash, tb_user.role AS tb_user_role, tb_user.tenant_id AS tb_user_tenant_id, tb_user.is_active AS tb_user_is_active, tb_user.last_login_at AS tb_user_last_login_at, tb_user.email_encrypted AS tb_user_email_encrypted, tb_user.phone_encrypted AS tb_user_phone_encrypted, tb_user.id AS tb_user_id, tb_user.created_at AS tb_user_created_at, tb_user.updated_at AS tb_user_updated_at 
FROM tb_user 
WHERE tb_user.id = %(pk_1)s::VARCHAR
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- SELECT tb_user.username AS tb_user_username, tb_user.password_hash AS tb_user_password_hash, tb_user.role AS tb_user_role, tb_user.tenant_id AS tb_user_tenant_id, tb_user.is_active AS tb_user_is_active, tb_user.last_login_at AS tb_user_last_login_at, tb_user.email_encrypted AS tb_user_email_encrypted, tb_user.phone_encrypted AS tb_user_phone_encrypted, tb_user.id AS tb_user_id, tb_user.created_at AS tb_user_created_at, tb_user.updated_at AS tb_user_updated_at 
FROM tb_user 
WHERE tb_user.id = %(pk_1)s::VARCHAR taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,520 INFO sqlalchemy.engine.Engine [generated in 0.00039s] {'pk_1': '84a3c0e5-7fd3-4232-bf9c-bc431c948957'}
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [generated in 0.00039s] {'pk_1': '84a3c0e5-7fd3-4232-bf9c-bc431c948957'} taskName=None asctime=2026-01-19T12:16:09+0900
INFO:     127.0.0.1:40366 - "POST /auth/login HTTP/1.1" 200 OK
2026-01-19 12:16:09,543 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- ROLLBACK taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,563 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- BEGIN (implicit) taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,566 INFO sqlalchemy.engine.Engine SELECT tb_user.username AS tb_user_username, tb_user.password_hash AS tb_user_password_hash, tb_user.role AS tb_user_role, tb_user.tenant_id AS tb_user_tenant_id, tb_user.is_active AS tb_user_is_active, tb_user.last_login_at AS tb_user_last_login_at, tb_user.email_encrypted AS tb_user_email_encrypted, tb_user.phone_encrypted AS tb_user_phone_encrypted, tb_user.id AS tb_user_id, tb_user.created_at AS tb_user_created_at, tb_user.updated_at AS tb_user_updated_at 
FROM tb_user 
WHERE tb_user.id = %(pk_1)s::VARCHAR
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- SELECT tb_user.username AS tb_user_username, tb_user.password_hash AS tb_user_password_hash, tb_user.role AS tb_user_role, tb_user.tenant_id AS tb_user_tenant_id, tb_user.is_active AS tb_user_is_active, tb_user.last_login_at AS tb_user_last_login_at, tb_user.email_encrypted AS tb_user_email_encrypted, tb_user.phone_encrypted AS tb_user_phone_encrypted, tb_user.id AS tb_user_id, tb_user.created_at AS tb_user_created_at, tb_user.updated_at AS tb_user_updated_at 
FROM tb_user 
WHERE tb_user.id = %(pk_1)s::VARCHAR taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,566 INFO sqlalchemy.engine.Engine [generated in 0.00051s] {'pk_1': '84a3c0e5-7fd3-4232-bf9c-bc431c948957'}
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [generated in 0.00051s] {'pk_1': '84a3c0e5-7fd3-4232-bf9c-bc431c948957'} taskName=None asctime=2026-01-19T12:16:09+0900
2026-01-19 12:16:09,583 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-19T12:16:09+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- ROLLBACK taskName=None asctime=2026-01-19T12:16:09+0900
INFO:     127.0.0.1:40372 - "POST /asset-registry/assets HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/h11_impl.py", line 410, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1135, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/applications.py", line 107, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/core/security_middleware.py", line 28, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/core/security_middleware.py", line 109, in dispatch
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/core/security_middleware.py", line 194, in dispatch
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/core/middleware.py", line 26, in dispatch
    |     response: Response = await call_next(request)
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 345, in app
    |     solved_result = await solve_dependencies(
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 645, in solve_dependencies
    |     solved = await run_in_threadpool(call, **solved_result.values)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/concurrency.py", line 32, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/anyio/to_thread.py", line 63, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 2502, in run_sync_in_worker_thread
    |     return await future
    |            ^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 986, in run
    |     result = context.run(func, *args)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/app/modules/asset_registry/router.py", line 30, in <lambda>
    |     session: Session = Depends(lambda: Session.begin()),
    |                                        ^^^^^^^^^^^^^^^
    | TypeError: Session.begin() missing 1 required positional argument: 'self'
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/h11_impl.py", line 410, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1135, in __call__
    await super().__call__(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/core/security_middleware.py", line 28, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/core/security_middleware.py", line 109, in dispatch
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/core/security_middleware.py", line 194, in dispatch
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/core/middleware.py", line 26, in dispatch
    response: Response = await call_next(request)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 345, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 645, in solve_dependencies
    solved = await run_in_threadpool(call, **solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/anyio/to_thread.py", line 63, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 2502, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 986, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/app/modules/asset_registry/router.py", line 30, in <lambda>
    session: Session = Depends(lambda: Session.begin()),
                                       ^^^^^^^^^^^^^^^
TypeError: Session.begin() missing 1 required positional argument: 'self'
2026-01-19 12:16:43,512 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- BEGIN (implicit) taskName=None asctime=2026-01-19T12:16:43+0900
2026-01-19 12:16:43,512 INFO sqlalchemy.engine.Engine SELECT tb_user.username, tb_user.password_hash, tb_user.role, tb_user.tenant_id, tb_user.is_active, tb_user.last_login_at, tb_user.email_encrypted, tb_user.phone_encrypted, tb_user.id, tb_user.created_at, tb_user.updated_at 
FROM tb_user 
WHERE tb_user.username = %(username_1)s::VARCHAR
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- SELECT tb_user.username, tb_user.password_hash, tb_user.role, tb_user.tenant_id, tb_user.is_active, tb_user.last_login_at, tb_user.email_encrypted, tb_user.phone_encrypted, tb_user.id, tb_user.created_at, tb_user.updated_at 
FROM tb_user 
WHERE tb_user.username = %(username_1)s::VARCHAR taskName=None asctime=2026-01-19T12:16:43+0900
2026-01-19 12:16:43,513 INFO sqlalchemy.engine.Engine [cached since 34.37s ago] {'username_1': 'admin@tobit.local'}
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [cached since 34.37s ago] {'username_1': 'admin@tobit.local'} taskName=None asctime=2026-01-19T12:16:43+0900
2026-01-19 12:16:43,761 INFO sqlalchemy.engine.Engine INSERT INTO tb_refresh_token (user_id, token_hash, expires_at, revoked_at, id, created_at) VALUES (%(user_id)s::VARCHAR, %(token_hash)s::VARCHAR, %(expires_at)s::TIMESTAMP WITHOUT TIME ZONE, %(revoked_at)s::TIMESTAMP WITHOUT TIME ZONE, %(id)s::VARCHAR, %(created_at)s::TIMESTAMP WITHOUT TIME ZONE)
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- INSERT INTO tb_refresh_token (user_id, token_hash, expires_at, revoked_at, id, created_at) VALUES (%(user_id)s::VARCHAR, %(token_hash)s::VARCHAR, %(expires_at)s::TIMESTAMP WITHOUT TIME ZONE, %(revoked_at)s::TIMESTAMP WITHOUT TIME ZONE, %(id)s::VARCHAR, %(created_at)s::TIMESTAMP WITHOUT TIME ZONE) taskName=None asctime=2026-01-19T12:16:43+0900
2026-01-19 12:16:43,761 INFO sqlalchemy.engine.Engine [cached since 34.29s ago] {'user_id': '84a3c0e5-7fd3-4232-bf9c-bc431c948957', 'token_hash': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4NGEzYzBlNS03ZmQzLTQyMzItYmY5Yy1iYzQzMWM5NDg5NTciLCJleHAiOjE3NjkzOTc0MDMsInR5cGUiOiJyZWZyZXNoIn0.ouZUBMsp4fChYywof5id4NSJmNnbv7NhhwBiX8V10OM', 'expires_at': datetime.datetime(2026, 1, 26, 3, 16, 43, 760705, tzinfo=datetime.timezone.utc), 'revoked_at': None, 'id': '5c638996-0ecc-481f-bf07-1435b677c1cf', 'created_at': datetime.datetime(2026, 1, 19, 3, 16, 43, 760868, tzinfo=datetime.timezone.utc)}
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [cached since 34.29s ago] {'user_id': '84a3c0e5-7fd3-4232-bf9c-bc431c948957', 'token_hash': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4NGEzYzBlNS03ZmQzLTQyMzItYmY5Yy1iYzQzMWM5NDg5NTciLCJleHAiOjE3NjkzOTc0MDMsInR5cGUiOiJyZWZyZXNoIn0.ouZUBMsp4fChYywof5id4NSJmNnbv7NhhwBiX8V10OM', 'expires_at': datetime.datetime(2026, 1, 26, 3, 16, 43, 760705, tzinfo=datetime.timezone.utc), 'revoked_at': None, 'id': '5c638996-0ecc-481f-bf07-1435b677c1cf', 'created_at': datetime.datetime(2026, 1, 19, 3, 16, 43, 760868, tzinfo=datetime.timezone.utc)} taskName=None asctime=2026-01-19T12:16:43+0900
2026-01-19 12:16:43,781 INFO sqlalchemy.engine.Engine UPDATE tb_user SET last_login_at=%(last_login_at)s::TIMESTAMP WITHOUT TIME ZONE WHERE tb_user.id = %(tb_user_id)s::VARCHAR
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- UPDATE tb_user SET last_login_at=%(last_login_at)s::TIMESTAMP WITHOUT TIME ZONE WHERE tb_user.id = %(tb_user_id)s::VARCHAR taskName=None asctime=2026-01-19T12:16:43+0900
2026-01-19 12:16:43,781 INFO sqlalchemy.engine.Engine [cached since 34.3s ago] {'last_login_at': datetime.datetime(2026, 1, 19, 3, 16, 43, 760962, tzinfo=datetime.timezone.utc), 'tb_user_id': '84a3c0e5-7fd3-4232-bf9c-bc431c948957'}
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [cached since 34.3s ago] {'last_login_at': datetime.datetime(2026, 1, 19, 3, 16, 43, 760962, tzinfo=datetime.timezone.utc), 'tb_user_id': '84a3c0e5-7fd3-4232-bf9c-bc431c948957'} taskName=None asctime=2026-01-19T12:16:43+0900
2026-01-19 12:16:43,802 INFO sqlalchemy.engine.Engine COMMIT
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- COMMIT taskName=None asctime=2026-01-19T12:16:43+0900
2026-01-19 12:16:43,822 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- BEGIN (implicit) taskName=None asctime=2026-01-19T12:16:43+0900
2026-01-19 12:16:43,823 INFO sqlalchemy.engine.Engine SELECT tb_user.username AS tb_user_username, tb_user.password_hash AS tb_user_password_hash, tb_user.role AS tb_user_role, tb_user.tenant_id AS tb_user_tenant_id, tb_user.is_active AS tb_user_is_active, tb_user.last_login_at AS tb_user_last_login_at, tb_user.email_encrypted AS tb_user_email_encrypted, tb_user.phone_encrypted AS tb_user_phone_encrypted, tb_user.id AS tb_user_id, tb_user.created_at AS tb_user_created_at, tb_user.updated_at AS tb_user_updated_at 
FROM tb_user 
WHERE tb_user.id = %(pk_1)s::VARCHAR
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- SELECT tb_user.username AS tb_user_username, tb_user.password_hash AS tb_user_password_hash, tb_user.role AS tb_user_role, tb_user.tenant_id AS tb_user_tenant_id, tb_user.is_active AS tb_user_is_active, tb_user.last_login_at AS tb_user_last_login_at, tb_user.email_encrypted AS tb_user_email_encrypted, tb_user.phone_encrypted AS tb_user_phone_encrypted, tb_user.id AS tb_user_id, tb_user.created_at AS tb_user_created_at, tb_user.updated_at AS tb_user_updated_at 
FROM tb_user 
WHERE tb_user.id = %(pk_1)s::VARCHAR taskName=None asctime=2026-01-19T12:16:43+0900
2026-01-19 12:16:43,823 INFO sqlalchemy.engine.Engine [cached since 34.3s ago] {'pk_1': '84a3c0e5-7fd3-4232-bf9c-bc431c948957'}
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [cached since 34.3s ago] {'pk_1': '84a3c0e5-7fd3-4232-bf9c-bc431c948957'} taskName=None asctime=2026-01-19T12:16:43+0900
INFO:     127.0.0.1:55510 - "POST /auth/login HTTP/1.1" 200 OK
2026-01-19 12:16:43,850 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- ROLLBACK taskName=None asctime=2026-01-19T12:16:43+0900
2026-01-19 12:16:43,946 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- BEGIN (implicit) taskName=None asctime=2026-01-19T12:16:43+0900
2026-01-19 12:16:43,947 INFO sqlalchemy.engine.Engine SELECT tb_user.username AS tb_user_username, tb_user.password_hash AS tb_user_password_hash, tb_user.role AS tb_user_role, tb_user.tenant_id AS tb_user_tenant_id, tb_user.is_active AS tb_user_is_active, tb_user.last_login_at AS tb_user_last_login_at, tb_user.email_encrypted AS tb_user_email_encrypted, tb_user.phone_encrypted AS tb_user_phone_encrypted, tb_user.id AS tb_user_id, tb_user.created_at AS tb_user_created_at, tb_user.updated_at AS tb_user_updated_at 
FROM tb_user 
WHERE tb_user.id = %(pk_1)s::VARCHAR
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- SELECT tb_user.username AS tb_user_username, tb_user.password_hash AS tb_user_password_hash, tb_user.role AS tb_user_role, tb_user.tenant_id AS tb_user_tenant_id, tb_user.is_active AS tb_user_is_active, tb_user.last_login_at AS tb_user_last_login_at, tb_user.email_encrypted AS tb_user_email_encrypted, tb_user.phone_encrypted AS tb_user_phone_encrypted, tb_user.id AS tb_user_id, tb_user.created_at AS tb_user_created_at, tb_user.updated_at AS tb_user_updated_at 
FROM tb_user 
WHERE tb_user.id = %(pk_1)s::VARCHAR taskName=None asctime=2026-01-19T12:16:43+0900
2026-01-19 12:16:43,947 INFO sqlalchemy.engine.Engine [cached since 34.38s ago] {'pk_1': '84a3c0e5-7fd3-4232-bf9c-bc431c948957'}
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- [cached since 34.38s ago] {'pk_1': '84a3c0e5-7fd3-4232-bf9c-bc431c948957'} taskName=None asctime=2026-01-19T12:16:43+0900
2026-01-19 12:16:43,971 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-19T12:16:43+0900 INFO sqlalchemy.engine.Engine request_id=- tenant_id=- trace_id=- mode=- ROLLBACK taskName=None asctime=2026-01-19T12:16:43+0900
INFO:     127.0.0.1:38848 - "POST /asset-registry/assets HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/h11_impl.py", line 410, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1135, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/applications.py", line 107, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/core/security_middleware.py", line 28, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/core/security_middleware.py", line 109, in dispatch
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/core/security_middleware.py", line 194, in dispatch
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/core/middleware.py", line 26, in dispatch
    |     response: Response = await call_next(request)
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 345, in app
    |     solved_result = await solve_dependencies(
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 645, in solve_dependencies
    |     solved = await run_in_threadpool(call, **solved_result.values)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/concurrency.py", line 32, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/anyio/to_thread.py", line 63, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 2502, in run_sync_in_worker_thread
    |     return await future
    |            ^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 986, in run
    |     result = context.run(func, *args)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/spa/tobit-spa-ai/apps/api/app/modules/asset_registry/router.py", line 30, in <lambda>
    |     session: Session = Depends(get_session),
    |                                        ^^^^^^
    | TypeError: Session.begin() missing 1 required positional argument: 'self'
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/h11_impl.py", line 410, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1135, in __call__
    await super().__call__(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/core/security_middleware.py", line 28, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/core/security_middleware.py", line 109, in dispatch
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/core/security_middleware.py", line 194, in dispatch
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/core/middleware.py", line 26, in dispatch
    response: Response = await call_next(request)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 345, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 645, in solve_dependencies
    solved = await run_in_threadpool(call, **solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/starlette/concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/anyio/to_thread.py", line 63, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 2502, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/.venv/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 986, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/spa/tobit-spa-ai/apps/api/app/modules/asset_registry/router.py", line 30, in <lambda>
    session: Session = Depends(get_session),
                                       ^^^^^^
TypeError: Session.begin() missing 1 required positional argument: 'self'
