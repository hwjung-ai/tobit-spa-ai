{
  "id": "cep_monitoring",
  "screen_id": "cep_monitoring",
  "name": "CEP Monitoring",
  "version": "2.0",
  "description": "Complex Event Processing monitoring dashboard with rules, events, channels, and error analysis",
  "layout": {
    "type": "dashboard",
    "direction": "vertical",
    "spacing": 16
  },
  "components": [
    {
      "id": "cep_header",
      "type": "row",
      "label": "Header Row",
      "props": {
        "gap": 4,
        "components": [
          {
            "id": "cep_title",
            "type": "text",
            "label": "Title",
            "props": {
              "content": "CEP Monitoring Dashboard",
              "variant": "heading",
              "fontSize": "lg",
              "fontWeight": "semibold"
            }
          },
          {
            "id": "cep_refresh_btn",
            "type": "button",
            "label": "Refresh",
            "props": {
              "label": "Refresh Now",
              "variant": "default",
              "auto_refresh": {
                "enabled": true,
                "interval_ms": 30000,
                "max_failures": 3,
                "backoff_ms": 5000
              }
            },
            "actions": [
              {
                "id": "action_refresh_cep",
                "handler": "fetch_cep_stats",
                "label": "Refresh CEP Stats",
                "payload_template": { "period": "24h" },
                "continue_on_error": false,
                "stop_on_error": true,
                "retry_count": 1,
                "retry_delay_ms": 1000
              }
            ]
          }
        ]
      }
    },
    {
      "id": "cep_kpi_row",
      "type": "row",
      "label": "KPI Row",
      "props": {
        "gap": 3,
        "components": [
          {
            "id": "cep_kpi_rules",
            "type": "keyvalue",
            "label": "Rules",
            "props": {
              "items": [
                { "key": "Total Rules", "value": "{{state.total_rules}}" },
                { "key": "Active", "value": "{{state.active_rules}}" }
              ]
            }
          },
          {
            "id": "cep_kpi_executions",
            "type": "keyvalue",
            "label": "Executions",
            "props": {
              "items": [
                { "key": "Today", "value": "{{state.today_execution_count}}" },
                { "key": "Last 24h", "value": "{{state.last_24h_execution_count}}" }
              ]
            }
          },
          {
            "id": "cep_kpi_performance",
            "type": "keyvalue",
            "label": "Performance",
            "props": {
              "items": [
                { "key": "Avg Duration", "value": "{{state.today_avg_duration_ms}}ms" },
                { "key": "Error Rate", "value": "{{state.today_error_rate}}" }
              ]
            }
          },
          {
            "id": "cep_kpi_alerts",
            "type": "keyvalue",
            "label": "Alerts",
            "props": {
              "items": [
                { "key": "Today Errors", "value": "{{state.today_error_count}}" },
                { "key": "Total Errors", "value": "{{state.total_errors}}" }
              ]
            }
          }
        ]
      }
    },
    {
      "id": "cep_rules_table",
      "type": "table",
      "label": "CEP Rules Performance",
      "props": {
        "rows": "{{state.cep_rules}}",
        "columns": [
          { "field": "rule_name", "header": "Rule Name", "sortable": true },
          { "field": "trigger_type", "header": "Trigger Type", "sortable": true },
          { "field": "is_active", "header": "Active" },
          { "field": "execution_count", "header": "Executions", "sortable": true },
          { "field": "error_rate", "header": "Error Rate", "sortable": true },
          { "field": "avg_duration_ms", "header": "Avg Duration (ms)", "sortable": true }
        ],
        "sortable": true,
        "page_size": 10
      }
    },
    {
      "id": "cep_channels_row",
      "type": "row",
      "label": "Channels Status",
      "props": {
        "gap": 3,
        "components": [
          {
            "id": "cep_channels_table",
            "type": "table",
            "label": "Notification Channels",
            "props": {
              "rows": "{{state.channels}}",
              "columns": [
                { "field": "display_name", "header": "Channel" },
                { "field": "active", "header": "Active" },
                { "field": "inactive", "header": "Inactive" },
                { "field": "total_sent", "header": "Sent (24h)" },
                { "field": "total_failed", "header": "Failed" },
                { "field": "failure_rate", "header": "Failure Rate" }
              ],
              "sortable": true,
              "page_size": 10,
              "conditional_styles": [
                {
                  "field": "failure_rate",
                  "operator": "gt",
                  "value": 0.1,
                  "color": "#ffffff",
                  "bg_color": "#ef4444"
                }
              ]
            }
          }
        ]
      }
    },
    {
      "id": "cep_events_table",
      "type": "table",
      "label": "Recent CEP Events (Errors)",
      "props": {
        "rows": "{{state.cep_events}}",
        "columns": [
          { "field": "triggered_at", "header": "Time", "sortable": true },
          { "field": "severity", "header": "Severity" },
          { "field": "rule_name", "header": "Rule" },
          { "field": "summary", "header": "Summary" },
          { "field": "status", "header": "Status" },
          { "field": "ack", "header": "Ack" }
        ],
        "sortable": true,
        "page_size": 10,
        "conditional_styles": [
          { "field": "severity", "operator": "eq", "value": "critical", "color": "#ffffff", "bg_color": "#ef4444" },
          { "field": "severity", "operator": "eq", "value": "high", "color": "#ffffff", "bg_color": "#f97316" },
          { "field": "severity", "operator": "eq", "value": "medium", "color": "#1f2937", "bg_color": "#f59e0b" },
          { "field": "severity", "operator": "eq", "value": "info", "color": "#1f2937", "bg_color": "#3b82f6" }
        ]
      }
    },
    {
      "id": "cep_error_timeline_chart",
      "type": "chart",
      "label": "Error Timeline",
      "props": {
        "chart_type": "line",
        "data": "{{state.error_timeline}}",
        "x_key": "timestamp",
        "series": [
          { "name": "Errors", "data_key": "error_count", "color": "#ef4444" }
        ],
        "y_min": 0
      }
    }
  ],
  "state": {
    "initial": {
      "total_rules": 0,
      "active_rules": 0,
      "today_execution_count": 0,
      "today_error_count": 0,
      "today_error_rate": 0,
      "today_avg_duration_ms": 0,
      "last_24h_execution_count": 0,
      "no_data_ratio": 0,
      "total_errors": 0,
      "cep_rules": [],
      "cep_events": [],
      "channels": [],
      "error_timeline": [],
      "error_distribution": {},
      "recent_errors": []
    },
    "schema": {
      "total_rules": { "type": "number" },
      "active_rules": { "type": "number" },
      "today_execution_count": { "type": "number" },
      "today_error_count": { "type": "number" },
      "today_error_rate": { "type": "number" },
      "today_avg_duration_ms": { "type": "number" },
      "last_24h_execution_count": { "type": "number" },
      "no_data_ratio": { "type": "number" },
      "total_errors": { "type": "number" },
      "cep_rules": { "type": "array" },
      "cep_events": { "type": "array" },
      "channels": { "type": "array" },
      "error_timeline": { "type": "array" },
      "error_distribution": { "type": "object" },
      "recent_errors": { "type": "array" }
    }
  },
  "actions": [
    {
      "id": "fetch_cep_stats",
      "label": "Fetch CEP Stats",
      "handler": "fetch_cep_stats",
      "payload_template": { "period": "24h" }
    }
  ],
  "bindings": null,
  "metadata": {
    "author": "System",
    "created_at": "2026-02-08",
    "notes": "CEP monitoring dashboard using built-in handler fetch_cep_stats. Loads rules performance, channels status, error timeline, and recent events.",
    "tags": {
      "category": "cep",
      "type": "monitoring",
      "auto_refresh": "true"
    }
  }
}
