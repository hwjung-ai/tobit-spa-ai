{
  "id": "cep_monitoring",
  "screen_id": "cep_monitoring",
  "name": "CEP Monitoring",
  "version": "1.0",
  "description": "Complex Event Processing monitoring dashboard with rules, events, and alerts",
  "layout": {
    "type": "dashboard",
    "direction": "vertical",
    "spacing": 16
  },
  "components": [
    {
      "id": "cep_header",
      "type": "row",
      "label": "Header Row",
      "props": {
        "gap": 4,
        "components": [
          {
            "id": "cep_title",
            "type": "text",
            "label": "Title",
            "props": {
              "content": "CEP Monitoring Dashboard",
              "variant": "heading"
            }
          },
          {
            "id": "cep_refresh_btn",
            "type": "button",
            "label": "Refresh",
            "props": {
              "label": "Refresh",
              "variant": "default"
            },
            "actions": [
              {
                "id": "action_refresh_stats",
                "handler": "fetch_cep_stats",
                "endpoint": "/cep/stats/summary",
                "method": "GET",
                "response_mapping": {
                  "total_rules": "stats.total_rules",
                  "active_rules": "stats.active_rules",
                  "today_execution_count": "stats.today_execution_count",
                  "today_error_count": "stats.today_error_count",
                  "today_error_rate": "stats.today_error_rate",
                  "today_avg_duration_ms": "stats.today_avg_duration_ms",
                  "last_24h_execution_count": "stats.last_24h_execution_count"
                },
                "continue_on_error": true
              },
              {
                "id": "action_refresh_events",
                "handler": "fetch_cep_events",
                "endpoint": "/cep/events?limit=100",
                "method": "GET",
                "response_mapping": {
                  "cep_events": "events"
                },
                "continue_on_error": true
              },
              {
                "id": "action_refresh_rules",
                "handler": "fetch_cep_rules",
                "endpoint": "/cep/rules",
                "method": "GET",
                "response_mapping": {
                  "cep_rules": "rules"
                },
                "continue_on_error": true
              },
              {
                "id": "action_refresh_summary",
                "handler": "fetch_cep_event_summary",
                "endpoint": "/cep/events/summary",
                "method": "GET",
                "response_mapping": {
                  "unacked_count": "summary.unacked_count",
                  "severity_critical": "summary.by_severity.critical",
                  "severity_high": "summary.by_severity.high",
                  "severity_warning": "summary.by_severity.medium",
                  "severity_info": "summary.by_severity.info"
                },
                "continue_on_error": true
              }
            ]
          }
        ]
      }
    },
    {
      "id": "cep_kpi_row",
      "type": "row",
      "label": "KPI Row",
      "props": {
        "gap": 3,
        "components": [
          {
            "id": "cep_kpi_rules",
            "type": "keyvalue",
            "label": "Rules",
            "props": {
              "items": [
                {
                  "key": "Total Rules",
                  "value": "{{state.total_rules}}"
                },
                {
                  "key": "Active",
                  "value": "{{state.active_rules}}"
                }
              ]
            }
          },
          {
            "id": "cep_kpi_executions",
            "type": "keyvalue",
            "label": "Executions",
            "props": {
              "items": [
                {
                  "key": "Today",
                  "value": "{{state.today_execution_count}}"
                },
                {
                  "key": "Last 24h",
                  "value": "{{state.last_24h_execution_count}}"
                }
              ]
            }
          },
          {
            "id": "cep_kpi_performance",
            "type": "keyvalue",
            "label": "Performance",
            "props": {
              "items": [
                {
                  "key": "Avg Duration",
                  "value": "{{state.today_avg_duration_ms}}ms"
                },
                {
                  "key": "Error Rate",
                  "value": "{{state.today_error_rate}}"
                }
              ]
            }
          },
          {
            "id": "cep_kpi_alerts",
            "type": "keyvalue",
            "label": "Alerts",
            "props": {
              "items": [
                {
                  "key": "Unacked",
                  "value": "{{state.unacked_count}}"
                },
                {
                  "key": "Critical",
                  "value": "{{state.severity_critical}}"
                }
              ]
            }
          }
        ]
      }
    },
    {
      "id": "cep_rules_table",
      "type": "table",
      "label": "CEP Rules",
      "props": {
        "rows": "{{state.cep_rules}}",
        "columns": [
          {
            "field": "rule_name",
            "header": "Rule Name",
            "sortable": true
          },
          {
            "field": "trigger_type",
            "header": "Trigger Type",
            "sortable": true
          },
          {
            "field": "is_active",
            "header": "Active"
          },
          {
            "field": "updated_at",
            "header": "Last Updated",
            "sortable": true
          }
        ],
        "sortable": true,
        "page_size": 10
      },
      "actions": [
        {
          "id": "action_auto_refresh_rules",
          "handler": "fetch_cep_rules",
          "endpoint": "/cep/rules",
          "method": "GET",
          "response_mapping": {
            "cep_rules": "rules"
          },
          "continue_on_error": true
        }
      ]
    },
    {
      "id": "cep_events_table",
      "type": "table",
      "label": "CEP Events",
      "props": {
        "rows": "{{state.cep_events}}",
        "columns": [
          {
            "field": "triggered_at",
            "header": "Time",
            "sortable": true
          },
          {
            "field": "severity",
            "header": "Severity"
          },
          {
            "field": "rule_name",
            "header": "Rule"
          },
          {
            "field": "summary",
            "header": "Summary"
          },
          {
            "field": "status",
            "header": "Status"
          },
          {
            "field": "ack",
            "header": "Ack"
          }
        ],
        "sortable": true,
        "page_size": 10,
        "auto_refresh": {
          "enabled": true,
          "interval_ms": 15000,
          "action_index": 0,
          "max_failures": 3,
          "backoff_ms": 5000
        },
        "conditional_styles": [
          {
            "field": "severity",
            "operator": "eq",
            "value": "critical",
            "color": "#ffffff",
            "bg_color": "#ef4444"
          },
          {
            "field": "severity",
            "operator": "eq",
            "value": "high",
            "color": "#ffffff",
            "bg_color": "#f97316"
          },
          {
            "field": "severity",
            "operator": "eq",
            "value": "medium",
            "color": "#1f2937",
            "bg_color": "#f59e0b"
          },
          {
            "field": "severity",
            "operator": "eq",
            "value": "info",
            "color": "#1f2937",
            "bg_color": "#3b82f6"
          }
        ]
      },
      "actions": [
        {
          "id": "action_auto_refresh_events",
          "handler": "fetch_cep_events",
          "endpoint": "/cep/events?limit=100",
          "method": "GET",
          "response_mapping": {
            "cep_events": "events"
          },
          "continue_on_error": true
        }
      ]
    }
  ],
  "state": {
    "initial": {
      "total_rules": 0,
      "active_rules": 0,
      "today_execution_count": 0,
      "today_error_count": 0,
      "today_error_rate": 0,
      "today_avg_duration_ms": 0,
      "last_24h_execution_count": 0,
      "unacked_count": 0,
      "severity_critical": 0,
      "severity_high": 0,
      "severity_warning": 0,
      "severity_info": 0,
      "cep_rules": [],
      "cep_events": []
    },
    "schema": {
      "total_rules": { "type": "number" },
      "active_rules": { "type": "number" },
      "today_execution_count": { "type": "number" },
      "today_error_count": { "type": "number" },
      "today_error_rate": { "type": "number" },
      "today_avg_duration_ms": { "type": "number" },
      "last_24h_execution_count": { "type": "number" },
      "unacked_count": { "type": "number" },
      "severity_critical": { "type": "number" },
      "severity_high": { "type": "number" },
      "severity_warning": { "type": "number" },
      "severity_info": { "type": "number" },
      "cep_rules": { "type": "array" },
      "cep_events": { "type": "array" }
    }
  },
  "actions": [
    {
      "id": "fetch_cep_stats",
      "label": "Fetch CEP Stats",
      "handler": "fetch_cep_stats",
      "endpoint": "/cep/stats/summary",
      "method": "GET",
      "response_mapping": {
        "total_rules": "stats.total_rules",
        "active_rules": "stats.active_rules",
        "today_execution_count": "stats.today_execution_count",
        "today_error_count": "stats.today_error_count",
        "today_error_rate": "stats.today_error_rate",
        "today_avg_duration_ms": "stats.today_avg_duration_ms",
        "last_24h_execution_count": "stats.last_24h_execution_count"
      }
    },
    {
      "id": "fetch_cep_events",
      "label": "Fetch CEP Events",
      "handler": "fetch_cep_events",
      "endpoint": "/cep/events?limit=100",
      "method": "GET",
      "response_mapping": {
        "cep_events": "events"
      }
    },
    {
      "id": "fetch_cep_rules",
      "label": "Fetch CEP Rules",
      "handler": "fetch_cep_rules",
      "endpoint": "/cep/rules",
      "method": "GET",
      "response_mapping": {
        "cep_rules": "rules"
      }
    },
    {
      "id": "fetch_cep_event_summary",
      "label": "Fetch CEP Event Summary",
      "handler": "fetch_cep_event_summary",
      "endpoint": "/cep/events/summary",
      "method": "GET",
      "response_mapping": {
        "unacked_count": "summary.unacked_count",
        "severity_critical": "summary.by_severity.critical",
        "severity_high": "summary.by_severity.high",
        "severity_warning": "summary.by_severity.medium",
        "severity_info": "summary.by_severity.info"
      }
    }
  ],
  "metadata": {
    "author": "CEP Administrator",
    "created_at": "2026-02-07",
    "notes": "CEP monitoring dashboard using /cep/* API endpoints",
    "tags": {
      "category": "cep",
      "type": "monitoring",
      "auto_refresh": "true"
    }
  }
}
